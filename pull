local library = loadstring(game:HttpGet("https://raw.githubusercontent.com/liebertsx/Tora-Library/main/src/library",true))()
local RunService = game:GetService("RunService")
local Players = game:GetService("Players")

local tab = library:CreateWindow("Utilities")
local folder = tab:AddFolder("Part Control")

-- Variables
local bringDistance = 50
local bringEnabled = false
local bringLoop -- loop connection for bring and noclip

-- Textbox to define bring distance
folder:AddBox({
    text = "Bring Distance",
    flag = "bring_distance",
    value = tostring(bringDistance),
    callback = function(val)
        local num = tonumber(val)
        if num then
            bringDistance = num
        end
    end
})

-- Function to teleport and anchor all "Handle" parts (except your own) 8 studs in front of player
local function bringHandles()
    local player = Players.LocalPlayer
    local char = player.Character
    local root = char and char:FindFirstChild("HumanoidRootPart")
    local ownHandles = {}
    -- Cache own handles to exclude from teleport
    if char then
        for _, part in ipairs(char:GetDescendants()) do
            if part:IsA("BasePart") and part.Name == "Handle" then
                ownHandles[part] = true
            end
        end
    end

    if not root then return end
    
    for _, part in ipairs(workspace:GetDescendants()) do
        if part:IsA("BasePart") and part.Name == "Handle" and not ownHandles[part] then
            if (part.Position - root.Position).Magnitude <= bringDistance then
                -- Move part 8 studs in front of player and anchor it
                local offset = root.CFrame.LookVector * 8
                part.CFrame = CFrame.new(root.Position + offset)
                part.Anchored = true
            end
        end
    end
end

-- Noclip function: Make player character parts non-collidable continuously
local function noclip()
    local player = Players.LocalPlayer
    local char = player.Character
    if not char then return end

    for _, part in ipairs(char:GetChildren()) do
        if part:IsA("BasePart") then
            part.CanCollide = false
        end
    end
end

-- Toggle to enable/disable bring + noclip loop
folder:AddToggle({
    text = "Bring nearest Handle and Noclip",
    flag = "bring_toggle",
    state = false,
    callback = function(state)
        bringEnabled = state
        if bringEnabled then
            bringLoop = RunService.RenderStepped:Connect(function()
                bringHandles()
                noclip()
                wait(0.1)
            end)
        else
            if bringLoop then
                bringLoop:Disconnect()
                bringLoop = nil
            end
            -- Optionally unanchor parts and reset CanCollide here if needed
        end
    end
})

library:Init()
